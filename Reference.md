# YATI Reference

<!-- markdown-toc start - Don't edit this section. Run M-x markdown-toc-refresh-toc -->
### Contents

- [Options](#options)
- [Mapping from Tiled elements to Godot elements](#mapping-from-tiled-elements-to-godot-elements)
- [Custom properties reference](#custom-properties-reference)
- [Specialities](#specialities)

<!-- markdown-toc end -->
  
## Options

### Use Tilemap Layers

Default: `Off`

In Godot 4 a tilemap can have layers. So it's possible to generate one tilemap with several layers instead of several tilemaps.  
Whoever prefers this behaviour (I don't) can switch on this option.  
Only adjacent tilemaps are combined into one with layers.  
Please note: Godot tilemap layers don't have offsets so if you have tile layers with offsets combining them into one Godot tilemap will end up looking wrong.

### Use Default Filter

Default: `Off`

To ensure that looks are the same as in Tiled, all layer texture filters are set to "nearest".
Setting this option to `On` leaves all texture filters as they are by default ('inherited').

### Post Processor

Default: `None`

After import you can manipulate the genereted map by a post processor script. The script must have a method "_post_process" with
a parameter of type Node2D (the base node of the generated map) and return the changed map as Node2D.  

Further GDScript requirements: "extends Node"

Mini Example (manipulating the Material setting on element with name 'Area2'):

```py
extends Node

func _post_process(base_node: Node2D):
	var area = base_node.find_child("Area2")
	var mat = CanvasItemMaterial.new()
	mat.blend_mode = CanvasItemMaterial.BLEND_MODE_MUL
	area.material = mat
	return base_node
	
```

Further C# Script requirements: Class name like .cs filename and inherit from Node.

Equivalent mini example (Post processor file is named 'PostProcessor.cs'):

```py
using Godot;

public partial class PostProcessor: Node
{
    public Node2D _PostProcess(Node2D baseNode)
    {
        var area = (Area2D)baseNode.FindChild("Area2");
        var mat = new CanvasItemMaterial();
        mat.BlendMode = CanvasItemMaterial.BlendModeEnum.Mul;
        area.Material = mat;
        return baseNode;
    }
}
	
```

### Save Tileset To

Default: `None`

Every map generated by the importer gets a Godot TileSet. This TileSet can be exported to a .tres file to use it otherwise.

## Mapping from Tiled elements to Godot elements

Where applicable the mapping is controlled by an entry in the Tiled class field.

Tile collision elements are controlled by custom properties of type 'int'.  
Property value is the assigned layer number.

**Names:** The Tiled element name entry is mapped to the Godot element name.  
If the Tiled name entry is empty a default Godot element name is created to avoid cryptic looking names.

| Tiled Element            | Class      | Property ('int') | Godot Element                             |
|--------------------------|------------|------------------|-------------------------------------------|
| Tile layer               |            |                  | TileMap                                   |
| Object layer             |            |                  | Node2D                                    |
| Group layer              |            |                  | (Parent) Node2D                           |
| Image layer              |            |                  | TextureRect                               |
||
| Tileset                  |            |                  | Atlas + Terrain Set                       |
| Terrain Set ("wangset")  |            |                  | Terrain                                   |
||
| Tile Collision polygon   |            | physics_layer    | Physics layer polygon                     |
|                          |            | navigation_layer | Navigation layer polygon                 |
|                          |            | occlusion_layer  | Occlusion layer polygon                   |
| Tile Collision rectangle |            | physics_layer    | Physics layer polygon                     |
|                          |            | navigation_layer | Navigation layer polygon                  |
|                          |            | occlusion_layer  | Occlusion layer polygon                   |
| Tile collision ellipse   |            |                  | n/a                                       |
| Tile animation           |            |                  | Tile animation (limited)                  |
||
| Tile object              |            |                  | Sprite2D                                  |
| Polygon object           | (body)     |                  | StaticBody2D + CollisionPolygon2D         |
|                          | area       |                  | Area2D + CollisionPolygon2D               |
|                          | navigation |                  | NavigationRegion2D                        |
|                          | occluder   |                  | LightOccluder2D + OcclusionPolygon2D      |
|                          | polygon    |                  | Polygon2D                                 |
| Rectangle object         | (body)     |                  | StaticBody2D + Rectangle CollisionShape2D |
|                          | area       |                  | Area2D + Rectangle CollisionShape2D       |
|                          | navigation |                  | NavigationRegion2D                        |
|                          | occluder   |                  | LightOccluder2D + OcclusionPolygon2D      |
| Ellipse object           | (body)     |                  | StaticBody2D + Capsule CollisionShape2D   |
|                          | area       |                  | Area2D + Capsule CollisionShape2D         |
| Polyline object          | (body)     |                  | StaticBody2D + Segment CollisionShape2D   |
|                          | area       |                  | Area2D + Segment CollisionShape2D         |
|                          | line       |                  | Line2D                                    |
|                          | path       |                  | Path2D                                    |
| Point object             |            |                  | Marker2D                                  |
| Text object              |            |                  | Label                                     |

## Custom properties reference

Setting these properties affects the Godot settings accordingly.  
Custom properties which are not in this list or not fitting to the element are added as Meta Data or - if assigned to a tile - as Custom Data.

Remarks:  
(*) refers to a string consisting of comma separated values, each value representing an element number to enable.  
Example for a collision layer property, where layers 1,3,5,6,7 are to enable:  
`collision_layer=1,3,5-7` (you can set ranges like 5-7 in this example)

(col) refers to a string consisting of an # followed by hex (RGB) values. Example: `#4e4aff`

(enum) refers to an int, value can be taken from the list

Properties of type 'file' refer to previously saved Godot resources.

| Godot Element       | Godot property                     | Tiled Element (to set property)          | Custom property                          | Type         | Enum value                                                                                                                          |
|---------------------|------------------------------------|------------------------------------------|------------------------------------------|--------------|-------------------------------------------------------------------------------------------------------------------------------------|
| TileSet             | Physics Layer n / Collision Layer  | Tileset                                  | collision_layer_n (n is layer number)    | string (*)   |                                                                                                                                     |
|                     | Physics Layer n / Collision Mask   |                                          | collision_mask_n  (n is layer number)    | string (*)   |                                                                                                                                     |
|                     | Navigation Layer n / Layers        |                                          | layers_n (n is layer number)             | string (*)   |                                                                                                                                     |
|                     | UV Clipping                        |                                          | uv_clipping                              | bool         |                                                                                                                                     |
|                     | Occlusion Layer n / Light Mask     |                                          | light_mask_n (n is layer number)         | string (*)   |                                                                                                                                     |
|                     | Occlusion Layer n / SDF Collision  |                                          | sdf_collision_n (n is layer number)      | bool         |                                                                                                                                     |
||
| Base Tile           | Texture Origin                     | Tile                                     | texture_origin_x                         | int          |                                                                                                                                     |
|                     |                                    |                                          | texture_origin_y                         | int          |                                                                                                                                     |
|                     | Modulate                           |                                          | modulate                                 | string (col) |                                                                                                                                     |
|                     | Material                           |                                          | material                                 | file         |                                                                                                                                     |
|                     | Z Index                            |                                          | z_index                                  | int          |                                                                                                                                     |
|                     | Y Sort Origin                      |                                          | y_sort_origin                            | int          |                                                                                                                                     |
|                     | Occlusion Layer Polygon            | Collision Polygon or Rectangle           | occlusion_layer                          | int          |                                                                                                                                     |
|                     | Physics Layer Polygon              | Collision Polygon or Rectangle           | physics_layer                            | int          |                                                                                                                                     |
|                     | Physics Layer n / Linear Velocity  | Collision Polygon or Rectangle           | linear_velocity_x_n (n is layer number)  | float        |                                                                                                                                     |
|                     |                                    |                                          | linear_velocity_y_n (n is layer number)  | float        |                                                                                                                                     |
|                     | Physics Layer n / Angular Velocity | Collision Polygon or Rectangle           | angular_velocity_x_n (n is layer number) | float        |                                                                                                                                     |
|                     | Navigation Layer Polygon           | Collision Polygon or Rectangle           | navigation_layer                         | int          |                                                                                                                                     |
||
| CanvasItem          | Modulate                           | Layer / Object                           | modulate                                 | string (col) |                                                                                                                                     |
|                     | Self Modulate                      |                                          | self_modulate                            | string (col) |                                                                                                                                     |
|                     | Show Behind Parent                 |                                          | show_behind_parent                       | bool         |                                                                                                                                     |
|                     | Top Level                          |                                          | top_level                                | bool         |                                                                                                                                     |
|                     | Clip Children                      |                                          | clip_children                            | int (enum)   | 0: Disabled, 1: Clip Only, 2: Clip+Draw                                                                                             |
|                     | Light Mask                         |                                          | light_mask                               | string (*)   |                                                                                                                                     |
|                     | Visibility Layer                   |                                          | visibility_layer                         | string (*)   |                                                                                                                                     |
|                     | Z Index                            |                                          | z_index                                  | int          |                                                                                                                                     |
|                     | Z As Relative                      |                                          | z_as_relative                            | bool         |                                                                                                                                     |
|                     | Y Sort Enabled                     |                                          | y_sort_enabled                           | bool         |                                                                                                                                     |
|                     | Texture Filter                     |                                          | texture_filter                           | int (enum)   | 0: Inherit, 1: Nearest, 2: Linear, 3: Nearest Mipmap, 4: Linear Mipmap, 5: Nearest Mipmap Anisotropic, 6: Linear Mipmap Anisotropic |
|                     | Texture Repeat                     |                                          | texture_repeat                           | int (enum)   | 0: Inherit, 1: Nearest, 2: Linear, 3: Nearest Mipmap, 4: Linear Mipmap, 5: Nearest Mipmap Anisotropic, 6: Linear Mipmap Anisotropic |
|                     | Material                           |                                          | material                                 | file         |                                                                                                                                     |
|                     | Use Parent Material                |                                          | use_parent_material                      | bool         |                                                                                                                                     |
||
| TileMap             | Cell Quadrant Size                 | Tile layer                               | cell_quadrant_size                       | int          |                                                                                                                                     |
|                     | Collision Animatable               |                                          | collision_animatable                     | bool         |                                                                                                                                     |
|                     | Collision Visibility Mode          |                                          | collision_visibility_mode                | int (enum)   | 0: Default, 1: Force Show, 2: Force Hide                                                                                            |
|                     | Navigation Visibility Mode         |                                          | navigation_visibility_mode               | int (enum)   | 0: Default, 1: Force Show, 2: Force Hide                                                                                            |
||
| CollisionObject2D   | Disable Mode                       | Objects with class "body" or "area"      | disable_mode                             | int (enum)   | 0: Remove, 1: Make Static, 2: Keep Active                                                                                           |
|                     | Collision Layer                    |                                          | collision_layer                          | string (*)   |                                                                                                                                     |
|                     | Collision Mask                     |                                          | collision_mask                           | string (*)   |                                                                                                                                     |
|                     | Collision Priority                 |                                          | collision_priority                       | float        |                                                                                                                                     |
|                     | Input Pickable                     |                                          | input_pickable                           | bool         |                                                                                                                                     |
||
| CollisionPolygon2D  | Build Mode                         | Polygon with class "body" or "area"      | build_mode                               | int (enum)   | 0: Solids, 1: Segments                                                                                                              |
| (both Polgon+Shape) | Disabled                           | Objects with class "body" or "area"      | disabled                                 | bool         |                                                                                                                                     |
| (both Polgon+Shape) | One Way Collision                  |                                          | one_way_collision                        | bool         |                                                                                                                                     |
| (both Polgon+Shape) | One Way Collision Margin           |                                          | one_way_collision_margin                 | float        |                                                                                                                                     |
| CollisionShape2D    | Debug Color                        |                                          | debug_color                              | string (col) |                                                                                                                                     |
||
| StaticBody2D        | Physics Material                   | Objects with class "body"                | physics_material                         | file         |                                                                                                                                     |
|                     | Constant Linear Velocity           |                                          | constant_linear_velocity_x               | float        |                                                                                                                                     |
|                     |                                    |                                          | constant_linear_velocity_y               | float        |                                                                                                                                     |
|                     | Constant Angular Velocity          |                                          | constant_angular_velocity                | float        |                                                                                                                                     |
||
| Area2D              | Monitoring                         | Objects with class "area"                | monitoring                               | bool         |                                                                                                                                     |
|                     | Monitorable                        |                                          | monitorable                              | bool         |                                                                                                                                     |
|                     | Priority                           |                                          | priority                                 | float        |                                                                                                                                     |
|                     | Gravity Space Override             |                                          | gravity_space_override                   | int (enum)   | 0: Disabled, 1: Combine, 2: Combine-Replace, 3: Replace, 4: Replace-Combine                                                         |
|                     | Gravity Point                      | `Remark: if space_override not disabled` | gravity_point                            | bool         |                                                                                                                                     |
|                     | Gravity Point Unit Distance        | `Remark: if gravity_point on`            | gravity_point_unit_distance              | float        |                                                                                                                                     |
|                     | Gravity Point Center               |                                          | gravity_point_center_x                   | float        |                                                                                                                                     |
|                     |                                    |                                          | gravity_point_center_y                   | float        |                                                                                                                                     |
|                     | Gravity Direction                  | `Remark: if gravity_point off`           | gravity_direction_x                      | float        |                                                                                                                                     |
|                     |                                    |                                          | gravity_direction_y                      | float        |                                                                                                                                     |
|                     | Gravity                            |                                          | gravity                                  | float        |                                                                                                                                     |
|                     | Linear Damp Space Override         |                                          | linear_damp_space_override               | int (enum)   | 0: Disabled, 1: Combine, 2: Combine-Replace, 3: Replace, 4: Replace-Combine                                                         |
|                     | Linear Damp                        | `Remark: if space_override not disabled` | gravity                                  | float        |                                                                                                                                     |
|                     | Angular Damp Space Override        |                                          | angular_damp_space_override              | int (enum)   | 0: Disabled, 1: Combine, 2: Combine-Replace, 3: Replace, 4: Replace-Combine                                                         |
|                     | Angular Damp                       | `Remark: if space_override not disabled` | gravity                                  | float        |                                                                                                                                     |
||
| NavigationRegion2D  | Enabled                            | Objects with class "navigation"          | enabled                                  | bool         |                                                                                                                                     |
|                     | Navigation Layers                  |                                          | navigation_layers                        | string (*)   |                                                                                                                                     |
|                     | Enter Cost                         |                                          | enter_cost                               | float        |                                                                                                                                     |
|                     | Travel Cost                        |                                          | travel_cost                              | float        |                                                                                                                                     |
||
| LightOccluder2D     | SDF Collision                      | Objects with class "occluder"            | sdf_collision                            | bool         |                                                                                                                                     |
|                     | Occluder Light Mask                |                                          | occluder_light_mask                      | string (*)   |                                                                                                                                     |
||
| Polygon2D           | Color                              | Objects with class "polygon"             | color                                    | string (col) |                                                                                                                                     |
| Line2D              | Width                              | Objects with class "line"                | width                                    | float        |                                                                                                                                     |
|                     | Default Color                      |                                          | default_color                            | string (col) |                                                                                                                                     |
| Marker2D            | Gizmo Extents                      | Point object                             | gizmo_extents                            | float        |                                                                                                                                     |

## Specialities

- For some custom properties e.g. 'use_parent_material' there's a catch that this can be ambiguous.  
`Example: A rectangle with class 'body' is mapped to a StaticBody2D (parent) + a CollisionShape2D (child).`  
`Both elements do have a 'use_parent_material' property. Which one of them should the property affect?`  
By default the property affects the parent.  
If you want the property to affect the child, prefix the name with two underscores e.g. '__use_parent_material'
- If linear texture filters are in effect, on tile objects (which are mapped to a Sprite2D) it may happen that the sprite shows artifacts on the border.  
This can be overcome by adding a special property to the object named 'clip_artifacts' and setting it to `On`.